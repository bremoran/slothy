/**
 * Copyright (c) 2023 Junhao Huang (jhhuang_nuaa@126.com)
 *
 * Licensed under the Apache License, Version 2.0(the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http:// www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
.syntax unified
.cpu cortex-m4
.thumb

// general macros
.macro load a, a0, a1, a2, a3, mem0, mem1, mem2, mem3
  ldr.w \a0, [\a, \mem0]
  ldr.w \a1, [\a, \mem1]
  ldr.w \a2, [\a, \mem2]
  ldr.w \a3, [\a, \mem3]
.endm

.macro store a, a0, a1, a2, a3, mem0, mem1, mem2, mem3
  str.w \a0, [\a, \mem0]
  str.w \a1, [\a, \mem1]
  str.w \a2, [\a, \mem2]
  str.w \a3, [\a, \mem3]
.endm

.macro mul_twiddle_plant a, twiddle, tmp, q, qa
 smulwb \tmp, \twiddle, \a
 smulwt \a,   \twiddle, \a
 smlabt \tmp, \tmp, \q, \qa
 smlabt \a, \a, \q, \qa
 pkhtb \a, \a, \tmp, asr #16
.endm

.macro doublebutterfly_plant a0, a1, twiddle, tmp, q, qa
 smulwb \tmp, \twiddle, \a1
 smulwt \a1, \twiddle, \a1
 smlabt \tmp, \tmp, \q, \qa
 smlabt \a1, \a1, \q, \qa
 pkhtb \tmp, \a1, \tmp, asr #16
 usub16 \a1, \a0, \tmp
 uadd16 \a0, \a0, \tmp
.endm

.macro two_doublebutterfly_plant a0, a1, a2, a3, twiddle0, twiddle1, tmp, q, qa
 doublebutterfly_plant \a0, \a1, \twiddle0, \tmp, \q, \qa
 doublebutterfly_plant \a2, \a3, \twiddle1, \tmp, \q, \qa
.endm

// #######
// #######
// # NTT #
// #######
// #######

.macro _3_layer_double_CT_16_plant c0, c1, c2, c3, c4, c5, c6, c7, twiddle1, twiddle2, twiddle_ptr, q, qa, tmp
 // layer 3
 ldr.w \twiddle1, [\twiddle_ptr], #28
 two_doublebutterfly_plant \c0, \c4, \c1, \c5, \twiddle1, \twiddle1, \tmp, \q, \qa
 two_doublebutterfly_plant \c2, \c6, \c3, \c7, \twiddle1, \twiddle1, \tmp, \q, \qa

 // layer 2
 ldrd \twiddle1, \twiddle2, [\twiddle_ptr, #-24]
 two_doublebutterfly_plant \c0, \c2, \c1, \c3, \twiddle1, \twiddle1, \tmp, \q, \qa

 two_doublebutterfly_plant \c4, \c6, \c5, \c7, \twiddle2, \twiddle2, \tmp, \q, \qa

 // layer 1
 ldrd \twiddle1, \twiddle2, [\twiddle_ptr, #-16]
 two_doublebutterfly_plant \c0, \c1, \c2, \c3, \twiddle1, \twiddle2, \tmp, \q, \qa

 ldrd \twiddle1, \twiddle2, [\twiddle_ptr, #-8]
 two_doublebutterfly_plant \c4, \c5, \c6, \c7, \twiddle1, \twiddle2, \tmp, \q, \qa
.endm

.macro _3_layer_double_CT_16_plant_fp c0, c1, c2, c3, c4, c5, c6, c7, xi0, xi1, xi2, xi3, xi4, xi5, xi6, twiddle1, twiddle2, q, qa, tmp
 // layer 3
 vmov \twiddle1, \xi0
 two_doublebutterfly_plant \c0, \c4, \c1, \c5, \twiddle1, \twiddle1, \tmp, \q, \qa
 two_doublebutterfly_plant \c2, \c6, \c3, \c7, \twiddle1, \twiddle1, \tmp, \q, \qa

 // layer 2
 vmov \twiddle1, \xi1
 vmov \twiddle2, \xi2
 two_doublebutterfly_plant \c0, \c2, \c1, \c3, \twiddle1, \twiddle1, \tmp, \q, \qa

 two_doublebutterfly_plant \c4, \c6, \c5, \c7, \twiddle2, \twiddle2, \tmp, \q, \qa

 // layer 1
 vmov \twiddle1, \xi3
 vmov \twiddle2, \xi4
 two_doublebutterfly_plant \c0, \c1, \c2, \c3, \twiddle1, \twiddle2, \tmp, \q, \qa

 vmov \twiddle1, \xi5
 vmov \twiddle2, \xi6
 two_doublebutterfly_plant \c4, \c5, \c6, \c7, \twiddle1, \twiddle2, \tmp, \q, \qa
.endm

.global small_ntt_asm_769_opt_m7
.type small_ntt_asm_769_opt_m7, %function
.align 2
small_ntt_asm_769_opt_m7:
 push {r4-r11, r14}
 vpush.w {s16-s27}
 poly         .req r0
 twiddle_ptr  .req r1
 poly0        .req r2
 poly1        .req r3
 poly2        .req r4
 poly3        .req r5
 poly4        .req r6
 poly5        .req r7
 poly6        .req r8
 poly7        .req r9
 twiddle1     .req r10
 twiddle2     .req r11
 ###  qinv        .req r11 ### q^-1 mod 2^2n; n=16
 q           .req r12
 ### at the top of r12
 qa          .req r0
 ### qa=2^a q;a=3; at the bottom of r12
 tmp         .req r14

 // movw qa, #24608
 // Why movt? Because we initially placed qa at the bottom of the same register as q;
 movt q, #769

 ### LAYER 7+6+5+4
 .equ distance, 256
 .equ offset, 32
 .equ strincr, 4
 // pre-load 15 twiddle factors to 15 FPU registers
 // s0-s7 used to temporary store 16 16-bit polys.
 vldm twiddle_ptr!, {s8-s22}

 add tmp, poly, #strincr*8
 // s23: poly addr
 // s24: tmp
        // s25: twiddle_ptr
 vmov s24, tmp
        vmov s25, twiddle_ptr
layer1234_loop:
                                           // Instructions:    299
                                           // Expected cycles: 159
                                           // Expected IPC:    1.88
                                           //
                                           // ------------------------------------------------------------------------------------------------------------------------------------------- original position -------------------------------------------------------------------------------------------------------------------------------------------->
                                           // 0                        25                       50                       75                       100                      125                      150                      175                      200                      225                      250                      275
                                           // |------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|-----------------------
        vmov r4, s8                        // *..........................................................................................................................................................................................................................................................................................................
        ldr.w r3, [r0, #416]               // .*.........................................................................................................................................................................................................................................................................................................
        vmov s23, r0                       // ...*.......................................................................................................................................................................................................................................................................................................
        ldr.w r7, [r0, #480]               // ..*........................................................................................................................................................................................................................................................................................................
        smulwt r2, r4, r3                  // ....*......................................................................................................................................................................................................................................................................................................
        ldr.w r6, [r0, #288]               // .....*.....................................................................................................................................................................................................................................................................................................
        ldr.w r10, [r0, #96]               // ............*..............................................................................................................................................................................................................................................................................................
        smulwb r3, r4, r3                  // .......*...................................................................................................................................................................................................................................................................................................
        smulwt r1, r4, r6                  // .........*.................................................................................................................................................................................................................................................................................................
        ldr.w r5, [r0, #224]               // ......*....................................................................................................................................................................................................................................................................................................
        ldr.w r8, [r0, #32]                // ........*..................................................................................................................................................................................................................................................................................................
        smulwb r11, r4, r6                 // ...........*...............................................................................................................................................................................................................................................................................................
        ldr.w r9, [r0, #352]               // ..........*................................................................................................................................................................................................................................................................................................
        smulwt r14, r4, r7                 // .............*.............................................................................................................................................................................................................................................................................................
        smulwb r6, r4, r7                  // ..............*............................................................................................................................................................................................................................................................................................
        ldr.w r7, [r0, #160]               // ...............*...........................................................................................................................................................................................................................................................................................
        movw r0, #24608                    // ................*..........................................................................................................................................................................................................................................................................................
        smlabt r3, r3, r12, r0             // .................*.........................................................................................................................................................................................................................................................................................
        smlabt r2, r2, r12, r0             // ..................*........................................................................................................................................................................................................................................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        smlabt r11, r11, r12, r0           // ...................*.......................................................................................................................................................................................................................................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        pkhtb r2, r2, r3, asr #16          // ....................*......................................................................................................................................................................................................................................................................................
        smlabt r14, r14, r12, r0           // .....................*.....................................................................................................................................................................................................................................................................................
        usub16 r3, r7, r2                  // ......................*....................................................................................................................................................................................................................................................................................
        smlabt r6, r6, r12, r0             // .......................*...................................................................................................................................................................................................................................................................................
        uadd16 r7, r7, r2                  // ........................*..................................................................................................................................................................................................................................................................................
        smlabt r1, r1, r12, r0             // .........................*.................................................................................................................................................................................................................................................................................
        smulwb r2, r4, r9                  // ..........................*................................................................................................................................................................................................................................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        pkhtb r11, r1, r11, asr #16        // ...........................*...............................................................................................................................................................................................................................................................................
        smulwt r1, r4, r9                  // ............................*..............................................................................................................................................................................................................................................................................
        vmov r9, s10                       // ..............................*............................................................................................................................................................................................................................................................................
        smlabt r4, r2, r12, r0             // .............................*.............................................................................................................................................................................................................................................................................
        pkhtb r6, r14, r6, asr #16         // ...............................*...........................................................................................................................................................................................................................................................................
        smlabt r1, r1, r12, r0             // ..................................*........................................................................................................................................................................................................................................................................
        uadd16 r14, r8, r11                // .................................*.........................................................................................................................................................................................................................................................................
        smulwb r2, r9, r3                  // ................................*..........................................................................................................................................................................................................................................................................
        pkhtb r4, r1, r4, asr #16          // .....................................*.....................................................................................................................................................................................................................................................................
        smulwt r1, r9, r3                  // ....................................*......................................................................................................................................................................................................................................................................
        usub16 r8, r8, r11                 // ...................................*.......................................................................................................................................................................................................................................................................
        smlabt r11, r2, r12, r0            // ......................................*....................................................................................................................................................................................................................................................................
        usub16 r3, r5, r6                  // .......................................*...................................................................................................................................................................................................................................................................
        smlabt r1, r1, r12, r0             // ........................................*..................................................................................................................................................................................................................................................................
        uadd16 r6, r5, r6                  // .........................................*.................................................................................................................................................................................................................................................................
        smulwt r2, r9, r3                  // ..........................................*................................................................................................................................................................................................................................................................
        pkhtb r5, r1, r11, asr #16         // ...........................................*...............................................................................................................................................................................................................................................................
        smulwb r3, r9, r3                  // ............................................*..............................................................................................................................................................................................................................................................
        usub16 r1, r10, r4                 // .............................................*.............................................................................................................................................................................................................................................................
        smlabt r9, r2, r12, r0             // ................................................*..........................................................................................................................................................................................................................................................
        vmov r2, s9                        // ...............................................*...........................................................................................................................................................................................................................................................
        smlabt r3, r3, r12, r0             // ..............................................*............................................................................................................................................................................................................................................................
        uadd16 r11, r10, r4                // .................................................*.........................................................................................................................................................................................................................................................
        smulwt r4, r2, r6                  // ....................................................*......................................................................................................................................................................................................................................................
        smulwb r6, r2, r6                  // ..................................................*........................................................................................................................................................................................................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        pkhtb r10, r9, r3, asr #16         // ...................................................*.......................................................................................................................................................................................................................................................
        smulwt r3, r2, r7                  // ....................................................................*......................................................................................................................................................................................................................................
        uadd16 r9, r1, r10                 // .....................................................*.....................................................................................................................................................................................................................................................
        smulwb r7, r2, r7                  // .................................................................*.........................................................................................................................................................................................................................................
        usub16 r2, r8, r5                  // ...............................................................*...........................................................................................................................................................................................................................................
        smlabt r6, r6, r12, r0             // ......................................................*....................................................................................................................................................................................................................................................
        uadd16 r5, r8, r5                  // .............................................................*.............................................................................................................................................................................................................................................
        smlabt r4, r4, r12, r0             // ........................................................*..................................................................................................................................................................................................................................................
        usub16 r8, r1, r10                 // .........................................................*.................................................................................................................................................................................................................................................
        smlabt r7, r7, r12, r0             // ......................................................................*....................................................................................................................................................................................................................................
        pkhtb r6, r4, r6, asr #16          // ...........................................................*...............................................................................................................................................................................................................................................
        smlabt r4, r3, r12, r0             // ........................................................................*..................................................................................................................................................................................................................................
        usub16 r10, r11, r6                // .............................................................................*.............................................................................................................................................................................................................................
        vmov r3, s14                       // ..................................................................*........................................................................................................................................................................................................................................
        pkhtb r7, r4, r7, asr #16          // ...........................................................................*...............................................................................................................................................................................................................................
        smulwb r1, r3, r8                  // .........................................................................*.................................................................................................................................................................................................................................
        vmov r4, s13                       // .......................................................*...................................................................................................................................................................................................................................................
        smulwt r3, r3, r8                  // ............................................................................*..............................................................................................................................................................................................................................
        uadd16 r11, r11, r6                // .........................................................................................*.................................................................................................................................................................................................................
        smlabt r8, r1, r12, r0             // ..............................................................................*............................................................................................................................................................................................................................
        vmov r6, s12                       // ..........................................................................*................................................................................................................................................................................................................................
        smlabt r1, r3, r12, r0             // ................................................................................*..........................................................................................................................................................................................................................
        smulwb r3, r4, r9                  // ..........................................................*................................................................................................................................................................................................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        pkhtb r8, r1, r8, asr #16          // ...................................................................................*.......................................................................................................................................................................................................................
        smulwt r1, r4, r9                  // ............................................................*..............................................................................................................................................................................................................................................
        usub16 r9, r2, r8                  // .....................................................................................*.....................................................................................................................................................................................................................
        smlabt r3, r3, r12, r0             // ..............................................................*............................................................................................................................................................................................................................................
        uadd16 r8, r2, r8                  // .......................................................................................*...................................................................................................................................................................................................................
        smlabt r2, r1, r12, r0             // ................................................................*..........................................................................................................................................................................................................................................
        smulwb r1, r6, r10                 // ..................................................................................*........................................................................................................................................................................................................................
        vmov r4, s20                       // ...........................................................................................*...............................................................................................................................................................................................................
        pkhtb r2, r2, r3, asr #16          // ...................................................................*.......................................................................................................................................................................................................................................
        smulwt r6, r6, r10                 // ....................................................................................*......................................................................................................................................................................................................................
        uadd16 r3, r5, r2                  // .......................................................................*...................................................................................................................................................................................................................................
        smlabt r1, r1, r12, r0             // ......................................................................................*....................................................................................................................................................................................................................
        usub16 r2, r5, r2                  // .....................................................................*.....................................................................................................................................................................................................................................
        smlabt r5, r6, r12, r0             // ........................................................................................*..................................................................................................................................................................................................................
        usub16 r6, r14, r7                 // .................................................................................*.........................................................................................................................................................................................................................
        smulwt r10, r4, r2                 // ..............................................................................................*............................................................................................................................................................................................................
        pkhtb r5, r5, r1, asr #16          // ..........................................................................................*................................................................................................................................................................................................................
        vmov r1, s19                       // ..................................................................................................*........................................................................................................................................................................................................
        uadd16 r14, r14, r7                // ...............................................................................*...........................................................................................................................................................................................................................
        smulwb r7, r1, r3                  // ......................................................................................................*....................................................................................................................................................................................................
        smulwt r3, r1, r3                  // .............................................................................................................*.............................................................................................................................................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        usub16 r1, r6, r5                  // ................................................................................................*..........................................................................................................................................................................................................
        smlabt r7, r7, r12, r0             // ...........................................................................................................*...............................................................................................................................................................................................
        uadd16 r6, r6, r5                  // ............................................................................................*..............................................................................................................................................................................................................
        smlabt r3, r3, r12, r0             // .......................................................................................................................*...................................................................................................................................................................................
        smlabt r5, r10, r12, r0            // ...................................................................................................*.......................................................................................................................................................................................................
        vmov r10, s18                      // ...............................................................................................*...........................................................................................................................................................................................................
        pkhtb r3, r3, r7, asr #16          // ..........................................................................................................................*................................................................................................................................................................................
        smulwb r7, r10, r1                 // .........................................................................................................*.................................................................................................................................................................................................
        smulwt r10, r10, r1                // ....................................................................................................*......................................................................................................................................................................................................
        vmov r1, s22                       // ....................................................................................................................*......................................................................................................................................................................................
        vmov s4, r3                        // ..............................................................................................................................*............................................................................................................................................................................
        smlabt r7, r7, r12, r0             // ............................................................................................................*..............................................................................................................................................................................................
        smlabt r3, r10, r12, r0            // .......................................................................................................*...................................................................................................................................................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        smulwb r10, r1, r9                 // ................................................................................................................................*..........................................................................................................................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        pkhtb r3, r3, r7, asr #16          // ................................................................................................................*..........................................................................................................................................................................................
        smulwt r1, r1, r9                  // ...................................................................................................................................*.......................................................................................................................................................................
        vmov s3, r3                        // ...................................................................................................................*.......................................................................................................................................................................................
        smlabt r10, r10, r12, r0           // .....................................................................................................................................*.....................................................................................................................................................................
        smlabt r1, r1, r12, r0             // ........................................................................................................................................*..................................................................................................................................................................
        vmov r9, s17                       // ..............................................................................................................*............................................................................................................................................................................................
        smulwb r3, r4, r2                  // .............................................................................................*.............................................................................................................................................................................................................
        vmov r7, s11                       // ......................................................................................................................*....................................................................................................................................................................................
        pkhtb r10, r1, r10, asr #16        // ...........................................................................................................................................*...............................................................................................................................................................
        smulwb r1, r9, r6                  // ...............................................................................................................*...........................................................................................................................................................................................
        vmov s7, r10                       // .............................................................................................................................................*.............................................................................................................................................................
        smlabt r10, r3, r12, r0            // .................................................................................................*.........................................................................................................................................................................................................
        smlabt r2, r1, r12, r0             // ..................................................................................................................*........................................................................................................................................................................................
        vmov r3, s23                       // ................................................................................................................................................*..........................................................................................................................................................
        ldr.w r4, [r3, #448]               // ...................................................................................................................................................................*.......................................................................................................................................
        smulwt r9, r9, r6                  // .................................................................................................................*.........................................................................................................................................................................................
        pkhtb r6, r5, r10, asr #16         // .....................................................................................................*.....................................................................................................................................................................................................
        smulwb r1, r7, r11                 // .........................................................................................................................*.................................................................................................................................................................................
        vmov r10, s16                      // .................................................................................................................................*.........................................................................................................................................................................
        smlabt r5, r9, r12, r0             // .....................................................................................................................*.....................................................................................................................................................................................
        vmov s5, r6                        // ........................................................................................................*..................................................................................................................................................................................................
        smulwt r7, r7, r11                 // ...........................................................................................................................*...............................................................................................................................................................................
        vmov r9, s15                       // ..........................................................................................................................................*................................................................................................................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        pkhtb r5, r5, r2, asr #16          // ........................................................................................................................*..................................................................................................................................................................................
        smlabt r1, r1, r12, r0             // .............................................................................................................................*.............................................................................................................................................................................
        smlabt r11, r7, r12, r0            // ...............................................................................................................................*...........................................................................................................................................................................
        vmov r6, s21                       // ..........................................................................................................*................................................................................................................................................................................................
        smulwt r2, r6, r8                  // ..............................................................................................................................................*............................................................................................................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        pkhtb r1, r11, r1, asr #16         // ..................................................................................................................................*........................................................................................................................................................................
        smulwb r6, r6, r8                  // .........................................................................................................................................*.................................................................................................................................................................
        uadd16 r7, r14, r1                 // ....................................................................................................................................*......................................................................................................................................................................
        smlabt r11, r2, r12, r0            // ..................................................................................................................................................*........................................................................................................................................................
        usub16 r8, r14, r1                 // ......................................................................................................................................*....................................................................................................................................................................
        smulwb r14, r9, r7                 // ....................................................................................................................................................*......................................................................................................................................................
        smulwt r9, r9, r7                  // ............................................................................................................................................*..............................................................................................................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        smlabt r1, r14, r12, r0            // ........................................................................................................................................................*..................................................................................................................................................
        ldr.w r7, [r3, #192]               // .........................................................................................................................................................*.................................................................................................................................................
        smlabt r9, r9, r12, r0             // ......................................................................................................................................................*....................................................................................................................................................
        ldr.w r14, [r3, #384]              // ...................................................................................................................................................*.......................................................................................................................................................
        smulwb r2, r10, r8                 // ............................................................................................................................................................*..............................................................................................................................................
        vmov s2, r5                        // ............................................................................................................................*..............................................................................................................................................................................
        smulwt r5, r10, r8                 // ..........................................................................................................................................................*................................................................................................................................................
        ldr.w r8, [r3, #320]               // .................................................................................................................................................................................*.........................................................................................................................
        pkhtb r10, r9, r1, asr #16         // .............................................................................................................................................................*.............................................................................................................................................
        smlabt r9, r2, r12, r0             // ...............................................................................................................................................................*...........................................................................................................................................
        vmov s0, r10                       // .................................................................................................................................................................*.........................................................................................................................................
        smlabt r1, r5, r12, r0             // ..............................................................................................................................................................*............................................................................................................................................
        vmov r10, s8                       // ...........................................................................................................................................................*...............................................................................................................................................
        smlabt r2, r6, r12, r0             // ...............................................................................................................................................*...........................................................................................................................................................
        pkhtb r0, r1, r9, asr #16          // .....................................................................................................................................................................*.....................................................................................................................................
        smulwb r9, r10, r4                 // .........................................................................................................................................................................*.................................................................................................................................
        vmov s1, r0                        // .......................................................................................................................................................................*...................................................................................................................................
        smulwt r5, r10, r14                // ....................................................................................................................................................................................*......................................................................................................................
        pkhtb r11, r11, r2, asr #16        // .....................................................................................................................................................*.....................................................................................................................................................
        smulwt r2, r10, r4                 // ............................................................................................................................................................................*..............................................................................................................................
        smulwb r14, r10, r14               // ..................................................................................................................................................................................*........................................................................................................................
        movw r0, #24608                    // ................................................................................................................................................................*..........................................................................................................................................
        vmov s6, r11                       // .......................................................................................................................................................*...................................................................................................................................................
        smlabt r6, r5, r12, r0             // ........................................................................................................................................................................................*..................................................................................................................
        vmov r1, s9                        // .......................................................................................................................................*...................................................................................................................................................................
        smlabt r9, r9, r12, r0             // ..............................................................................................................................................................................*............................................................................................................................
        smlabt r11, r2, r12, r0            // ................................................................................................................................................................................*..........................................................................................................................
        ldr.w r2, [r3, #64]                // ......................................................................................................................................................................................*....................................................................................................................
        smlabt r14, r14, r12, r0           // .....................................................................................................................................................................................*.....................................................................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        pkhtb r5, r11, r9, asr #16         // ...................................................................................................................................................................................*.......................................................................................................................
        smulwb r4, r10, r8                 // .........................................................................................................................................................................................*.................................................................................................................
        uadd16 r11, r7, r5                 // ..............................................................................................................................................................................................*............................................................................................................
        smulwt r8, r10, r8                 // ...........................................................................................................................................................................................*...............................................................................................................
        pkhtb r9, r6, r14, asr #16         // ..........................................................................................................................................................................................*................................................................................................................
        ldr.w r14, [r3, #0]                // ..........................................................................................................................................................................*................................................................................................................................
        smlabt r6, r4, r12, r0             // .............................................................................................................................................................................................*.............................................................................................................
        ldr.w r4, [r3, #256]               // .................................................................................................................................................*.........................................................................................................................................................
        usub16 r5, r7, r5                  // .....................................................................................................................................................................................................*.....................................................................................................
        smlabt r7, r8, r12, r0             // ...............................................................................................................................................................................................*...........................................................................................................
        smulwb r8, r10, r4                 // ..................................................................................................................................................................*........................................................................................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        pkhtb r7, r7, r6, asr #16          // ..................................................................................................................................................................................................*........................................................................................................
        smulwt r10, r10, r4                // ....................................................................................................................................................................*......................................................................................................................................
        smlabt r8, r8, r12, r0             // ......................................................................................................................................................................*....................................................................................................................................
        ldr.w r6, [r3, #128]               // .......................................................................................................................................................................................*...................................................................................................................
        uadd16 r3, r2, r7                  // .......................................................................................................................................................................................................*...................................................................................................
        smlabt r10, r10, r12, r0           // ........................................................................................................................................................................*..................................................................................................................................
        smulwb r4, r1, r11                 // .................................................................................................................................................................................................*.........................................................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        pkhtb r10, r10, r8, asr #16        // ...........................................................................................................................................................................*...............................................................................................................................
        smulwt r8, r1, r11                 // ...................................................................................................................................................................................................*.......................................................................................................
        usub16 r11, r2, r7                 // ...............................................................................................................................................................................................................*...........................................................................................
        smlabt r4, r4, r12, r0             // ....................................................................................................................................................................................................*......................................................................................................
        uadd16 r7, r14, r10                // ...............................................................................................................................................................................*...........................................................................................................................
        smlabt r8, r8, r12, r0             // ......................................................................................................................................................................................................*....................................................................................................
        usub16 r10, r14, r10               // .............................................................................................................................................................................*.............................................................................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        uadd16 r14, r6, r9                 // ................................................................................................................................................................................................*..........................................................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        usub16 r2, r6, r9                  // ............................................................................................................................................................................................*..............................................................................................................
        smulwb r6, r1, r14                 // ........................................................................................................................................................................................................*..................................................................................................
        smulwt r1, r1, r14                 // ..........................................................................................................................................................................................................*................................................................................................
        vmov r9, s11                       // ...............................................................................................................................................................................................................................*...........................................................................
        pkhtb r8, r8, r4, asr #16          // .........................................................................................................................................................................................................*.................................................................................................
        smlabt r4, r6, r12, r0             // ............................................................................................................................................................................................................*..............................................................................................
        uadd16 r6, r3, r8                  // ......................................................................................................................................................................................................................*....................................................................................
        smlabt r14, r1, r12, r0            // .............................................................................................................................................................................................................*.............................................................................................
        usub16 r8, r3, r8                  // ...........................................................................................................................................................................................................*...............................................................................................
        smulwt r3, r9, r6                  // .......................................................................................................................................................................................................................................*...................................................................
        smulwb r6, r9, r6                  // .....................................................................................................................................................................................................................................*.....................................................................
        vmov r1, s10                       // ...................................................................................................................................................................................................................*.......................................................................................
        pkhtb r9, r14, r4, asr #16         // .................................................................................................................................................................................................................*.........................................................................................
        smlabt r4, r3, r12, r0             // ...........................................................................................................................................................................................................................................*...............................................................
        usub16 r14, r7, r9                 // ..........................................................................................................................................................................................................................*................................................................................
        smlabt r3, r6, r12, r0             // .........................................................................................................................................................................................................................................*.................................................................
        uadd16 r9, r7, r9                  // ............................................................................................................................................................................................................................*..............................................................................
        smulwb r6, r1, r5                  // .......................................................................................................................................................................................................................*...................................................................................
        vmov r7, s12                       // ..............................................................................................................................................................................................................*............................................................................................
        smulwt r5, r1, r5                  // ...........................................................................................................................................................................................................................*...............................................................................
        pkhtb r3, r4, r3, asr #16          // ..............................................................................................................................................................................................................................................*............................................................
        smlabt r6, r6, r12, r0             // .............................................................................................................................................................................................................................*.............................................................................
        usub16 r4, r9, r3                  // ..................................................................................................................................................................................................................................................*........................................................
        smlabt r5, r5, r12, r0             // .................................................................................................................................................................................................................................*.........................................................................
        uadd16 r3, r9, r3                  // ......................................................................................................................................................................................................................................................*....................................................
        smulwb r9, r7, r8                  // ................................................................................................................................................................................................................*..........................................................................................
        pkhtb r5, r5, r6, asr #16          // ....................................................................................................................................................................................................................................*......................................................................
        smulwt r7, r7, r8                  // ..................................................................................................................................................................................................................*........................................................................................
        smlabt r6, r9, r12, r0             // ....................................................................................................................................................................................................................*......................................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        usub16 r9, r11, r5                 // ................................................................................................................................................................................................................................................*..........................................................
        smulwb r8, r1, r2                  // .........................................................................................................................................................................................................................*.................................................................................
        smulwt r1, r1, r2                  // ..............................................................................................................................................................................................................................*............................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        uadd16 r2, r11, r5                 // ............................................................................................................................................................................................................................................*..............................................................
        smlabt r5, r8, r12, r0             // ................................................................................................................................................................................................................................*..........................................................................
        smlabt r1, r1, r12, r0             // ...................................................................................................................................................................................................................................*.......................................................................
        // gap                             // ...........................................................................................................................................................................................................................................................................................................
        smlabt r8, r7, r12, r0             // .....................................................................................................................................................................................................................*.....................................................................................
        vmov r7, s13                       // .............................................................................................................................................................................................................................................*.............................................................
        pkhtb r5, r1, r5, asr #16          // ......................................................................................................................................................................................................................................*....................................................................
        smulwb r1, r7, r2                  // ...............................................................................................................................................................................................................................................*...........................................................
        uadd16 r11, r10, r5                // ....................................................................................................................................................................................................................................................*......................................................
        smulwt r2, r7, r2                  // .................................................................................................................................................................................................................................................*.........................................................
        smlabt r7, r1, r12, r0             // ...................................................................................................................................................................................................................................................*.......................................................
        vmov r1, s14                       // .......................................................................................................................................................................................................................................................*...................................................
        pkhtb r6, r8, r6, asr #16          // ........................................................................................................................................................................................................................*..................................................................................
        smulwt r8, r1, r9                  // ..........................................................................................................................................................................................................................................................*................................................
        smulwb r9, r1, r9                  // .........................................................................................................................................................................................................................................................*.................................................
        vmov r1, s2                        // ...............................................................................................................................................................................................................................................................................*...........................
        usub16 r5, r10, r5                 // ........................................................................................................................................................................................................................................*..................................................................
        smlabt r2, r2, r12, r0             // .....................................................................................................................................................................................................................................................*.....................................................
        uadd16 r10, r14, r6                // ..........................................................................................................................................................................................................................................*................................................................
        smlabt r9, r9, r12, r0             // .............................................................................................................................................................................................................................................................*.............................................
        pkhtb r7, r2, r7, asr #16          // ........................................................................................................................................................................................................................................................*..................................................
        smlabt r0, r8, r12, r0             // ...............................................................................................................................................................................................................................................................*...........................................
        usub16 r8, r14, r6                 // ..................................................................................................................................................................................................................................*........................................................................
        vmov r2, s3                        // ...................................................................................................................................................................................................................................................................*.......................................
        pkhtb r14, r0, r9, asr #16         // ..................................................................................................................................................................................................................................................................*........................................
        vmov r0, s23                       // .................................................................................................................................................................................................................................................................*.........................................
        usub16 r6, r8, r2                  // ................................................................................................................................................................................................................................................................................*..........................
        str.w r6, [r0, #224]               // ...................................................................................................................................................................................................................................................................................*.......................
        uadd16 r9, r8, r2                  // ............................................................................................................................................................................................................................................................................*..............................
        str.w r9, [r0, #192]               // .............................................................................................................................................................................................................................................................................*.............................
        uadd16 r9, r10, r1                 // ......................................................................................................................................................................................................................................................................................*....................
        str.w r9, [r0, #128]               // ...........................................................................................................................................................................................................................................................................................*...............
        usub16 r9, r10, r1                 // .......................................................................................................................................................................................................................................................................................................*...
        str.w r9, [r0, #160]               // ........................................................................................................................................................................................................................................................................................................*..
        usub16 r1, r11, r7                 // ..............................................................................................................................................................................................................................................................*............................................
        vmov r10, s1                       // .......................................................................................................................................................................................................................................................................*...................................
        uadd16 r2, r11, r7                 // ............................................................................................................................................................................................................................................................*..............................................
        vmov r9, s4                        // .........................................................................................................................................................................................................................................................................................*.................
        uadd16 r6, r5, r14                 // ......................................................................................................................................................................................................................................................................*....................................
        vmov r8, s7                        // .................................................................................................................................................................................................................................................................................*.........................
        usub16 r7, r4, r10                 // ..........................................................................................................................................................................................................................................................................*................................
        str.w r7, [r0, #96]                // ...........................................................................................................................................................................................................................................................................*...............................
        usub16 r11, r2, r9                 // ................................................................................................................................................................................................................................................................................................*..........
        str.w r11, [r0, #288]              // ......................................................................................................................................................................................................................................................................................................*....
        uadd16 r7, r4, r10                 // ........................................................................................................................................................................................................................................................................*..................................
        vmov r4, s5                        // ...........................................................................................................................................................................................................................................................*...............................................
        uadd16 r10, r1, r4                 // ..............................................................................................................................................................................................................................................................................*............................
        str.w r10, [r0, #320]              // .......................................................................................................................................................................................................................................................................................*...................
        usub16 r5, r5, r14                 // ....................................................................................................................................................................................................................................................................*......................................
        str.w r7, [r0, #64]                // .........................................................................................................................................................................................................................................................................*.................................
        uadd16 r10, r2, r9                 // ............................................................................................................................................................................................................................................................................................*..............
        str.w r10, [r0, #256]              // .............................................................................................................................................................................................................................................................................................*.............
        uadd16 r9, r5, r8                  // ..................................................................................................................................................................................................................................................................................*........................
        vmov r10, s6                       // ..........................................................................................................................................................................................................................................................................................*................
        vmov r2, s0                        // .................................................................................................................................................................................................................................................................................................*.........
        str.w r9, [r0, #448]               // ........................................................................................................................................................................................................................................................................................*..................
        usub16 r9, r6, r10                 // ..................................................................................................................................................................................................................................................................................................*........
        str.w r9, [r0, #416]               // ...................................................................................................................................................................................................................................................................................................*.......
        usub16 r8, r5, r8                  // ....................................................................................................................................................................................................................................................................................*......................
        str.w r8, [r0, #480]               // .....................................................................................................................................................................................................................................................................................*.....................
        usub16 r1, r1, r4                  // ................................................................................................................................................................................................................................................................*..........................................
        str.w r1, [r0, #352]               // .....................................................................................................................................................................................................................................................................*.....................................
        usub16 r8, r3, r2                  // ....................................................................................................................................................................................................................................................................................................*......
        str.w r8, [r0, #32]                // .....................................................................................................................................................................................................................................................................................................*.....
        uadd16 r4, r6, r10                 // ..............................................................................................................................................................................................................................................................................................*............
        str.w r4, [r0, #384]               // ...............................................................................................................................................................................................................................................................................................*...........
        uadd16 r14, r3, r2                 // .........................................................................................................................................................................................................................................................................................................*.
        str.w r14, [r0], #4                // ..........................................................................................................................................................................................................................................................................................................*

                                             // ---------------------------------------------------------------------------------------------------------------------------------------------- new position ---------------------------------------------------------------------------------------------------------------------------------------------->
                                             // 0                        25                       50                       75                       100                      125                      150                      175                      200                      225                      250                      275
                                             // |------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|------------------------|-----------------------
        // vmov r14, s8                      // *..........................................................................................................................................................................................................................................................................................................
        // ldr.w r8, [r0, #416]              // .*.........................................................................................................................................................................................................................................................................................................
        // ldr.w r11, [r0, #480]             // ...*.......................................................................................................................................................................................................................................................................................................
        // vmov s23, r0                      // ..*........................................................................................................................................................................................................................................................................................................
        // smulwt r4, r14, r8                // ....*......................................................................................................................................................................................................................................................................................................
        // ldr.w r10, [r0, #288]             // .....*.....................................................................................................................................................................................................................................................................................................
        // ldr.w r3, [r0, #224]              // .........*.................................................................................................................................................................................................................................................................................................
        // smulwb r7, r14, r8                // .......*...................................................................................................................................................................................................................................................................................................
        // ldr.w r5, [r0, #32]               // ..........*................................................................................................................................................................................................................................................................................................
        // smulwt r6, r14, r10               // ........*..................................................................................................................................................................................................................................................................................................
        // ldr.w r8, [r0, #352]              // ............*..............................................................................................................................................................................................................................................................................................
        // smulwb r10, r14, r10              // ...........*...............................................................................................................................................................................................................................................................................................
        // ldr.w r9, [r0, #96]               // ......*....................................................................................................................................................................................................................................................................................................
        // smulwt r1, r14, r11               // .............*.............................................................................................................................................................................................................................................................................................
        // smulwb r2, r14, r11               // ..............*............................................................................................................................................................................................................................................................................................
        // ldr.w r11, [r0, #160]             // ...............*...........................................................................................................................................................................................................................................................................................
        // movw r0, #24608                   // ................*..........................................................................................................................................................................................................................................................................................
        // smlabt r7, r7, r12, r0            // .................*.........................................................................................................................................................................................................................................................................................
        // smlabt r4, r4, r12, r0            // ..................*........................................................................................................................................................................................................................................................................................
        // smlabt r10, r10, r12, r0          // ...................*.......................................................................................................................................................................................................................................................................................
        // pkhtb r7, r4, r7, asr #16         // ....................*......................................................................................................................................................................................................................................................................................
        // smlabt r1, r1, r12, r0            // .....................*.....................................................................................................................................................................................................................................................................................
        // usub16 r4, r11, r7                // ......................*....................................................................................................................................................................................................................................................................................
        // smlabt r2, r2, r12, r0            // .......................*...................................................................................................................................................................................................................................................................................
        // uadd16 r11, r11, r7               // ........................*..................................................................................................................................................................................................................................................................................
        // smlabt r7, r6, r12, r0            // .........................*.................................................................................................................................................................................................................................................................................
        // smulwb r6, r14, r8                // ..........................*................................................................................................................................................................................................................................................................................
        // pkhtb r7, r7, r10, asr #16        // ...........................*...............................................................................................................................................................................................................................................................................
        // smulwt r8, r14, r8                // ............................*..............................................................................................................................................................................................................................................................................
        // smlabt r10, r6, r12, r0           // ..............................*............................................................................................................................................................................................................................................................................
        // vmov r6, s10                      // .............................*.............................................................................................................................................................................................................................................................................
        // pkhtb r2, r1, r2, asr #16         // ...............................*...........................................................................................................................................................................................................................................................................
        // smulwb r1, r6, r4                 // ..................................*........................................................................................................................................................................................................................................................................
        // uadd16 r14, r5, r7                // .................................*.........................................................................................................................................................................................................................................................................
        // smlabt r8, r8, r12, r0            // ................................*..........................................................................................................................................................................................................................................................................
        // usub16 r7, r5, r7                 // .....................................*.....................................................................................................................................................................................................................................................................
        // smulwt r5, r6, r4                 // ....................................*......................................................................................................................................................................................................................................................................
        // pkhtb r4, r8, r10, asr #16        // ...................................*.......................................................................................................................................................................................................................................................................
        // smlabt r10, r1, r12, r0           // ......................................*....................................................................................................................................................................................................................................................................
        // usub16 r8, r3, r2                 // .......................................*...................................................................................................................................................................................................................................................................
        // smlabt r5, r5, r12, r0            // ........................................*..................................................................................................................................................................................................................................................................
        // uadd16 r1, r3, r2                 // .........................................*.................................................................................................................................................................................................................................................................
        // smulwt r2, r6, r8                 // ..........................................*................................................................................................................................................................................................................................................................
        // pkhtb r5, r5, r10, asr #16        // ...........................................*...............................................................................................................................................................................................................................................................
        // smulwb r3, r6, r8                 // ............................................*..............................................................................................................................................................................................................................................................
        // usub16 r8, r9, r4                 // .............................................*.............................................................................................................................................................................................................................................................
        // smlabt r10, r3, r12, r0           // ................................................*..........................................................................................................................................................................................................................................................
        // vmov r3, s9                       // ...............................................*...........................................................................................................................................................................................................................................................
        // smlabt r6, r2, r12, r0            // ..............................................*............................................................................................................................................................................................................................................................
        // uadd16 r4, r9, r4                 // .................................................*.........................................................................................................................................................................................................................................................
        // smulwb r9, r3, r1                 // ...................................................*.......................................................................................................................................................................................................................................................
        // pkhtb r6, r6, r10, asr #16        // ....................................................*......................................................................................................................................................................................................................................................
        // smulwt r1, r3, r1                 // ..................................................*........................................................................................................................................................................................................................................................
        // uadd16 r10, r8, r6                // ......................................................*....................................................................................................................................................................................................................................................
        // smlabt r9, r9, r12, r0            // .........................................................*.................................................................................................................................................................................................................................................
        // vmov r2, s13                      // ....................................................................*......................................................................................................................................................................................................................................
        // smlabt r1, r1, r12, r0            // ...........................................................*...............................................................................................................................................................................................................................................
        // usub16 r8, r8, r6                 // ............................................................*..............................................................................................................................................................................................................................................
        // smulwb r6, r2, r10                // ..........................................................................*................................................................................................................................................................................................................................
        // pkhtb r1, r1, r9, asr #16         // ..............................................................*............................................................................................................................................................................................................................................
        // smulwt r2, r2, r10                // ............................................................................*..............................................................................................................................................................................................................................
        // uadd16 r10, r7, r5                // ..........................................................*................................................................................................................................................................................................................................................
        // smlabt r6, r6, r12, r0            // ..............................................................................*............................................................................................................................................................................................................................
        // usub16 r5, r7, r5                 // ........................................................*..................................................................................................................................................................................................................................................
        // smlabt r7, r2, r12, r0            // ................................................................................*..........................................................................................................................................................................................................................
        // smulwb r2, r3, r11                // .......................................................*...................................................................................................................................................................................................................................................
        // vmov r9, s14                      // .................................................................*.........................................................................................................................................................................................................................................
        // pkhtb r6, r7, r6, asr #16         // ...................................................................................*.......................................................................................................................................................................................................................
        // smulwt r3, r3, r11                // .....................................................*.....................................................................................................................................................................................................................................................
        // usub16 r7, r10, r6                // .......................................................................................*...................................................................................................................................................................................................................
        // smlabt r11, r2, r12, r0           // .............................................................*.............................................................................................................................................................................................................................................
        // uadd16 r6, r10, r6                // .....................................................................................*.....................................................................................................................................................................................................................
        // smlabt r2, r3, r12, r0            // ...............................................................*...........................................................................................................................................................................................................................................
        // smulwb r3, r9, r8                 // ...................................................................*.......................................................................................................................................................................................................................................
        // vmov r10, s12                     // ........................................................................*..................................................................................................................................................................................................................................
        // pkhtb r11, r2, r11, asr #16       // ..................................................................*........................................................................................................................................................................................................................................
        // smulwt r8, r9, r8                 // .....................................................................*.....................................................................................................................................................................................................................................
        // usub16 r9, r4, r1                 // ................................................................*..........................................................................................................................................................................................................................................
        // smlabt r3, r3, r12, r0            // .......................................................................*...................................................................................................................................................................................................................................
        // uadd16 r2, r14, r11               // .............................................................................................*.............................................................................................................................................................................................................
        // smlabt r8, r8, r12, r0            // .........................................................................*.................................................................................................................................................................................................................................
        // usub16 r14, r14, r11              // .........................................................................................*.................................................................................................................................................................................................................
        // smulwb r11, r10, r9               // .................................................................................*.........................................................................................................................................................................................................................
        // pkhtb r3, r8, r3, asr #16         // ...........................................................................*...............................................................................................................................................................................................................................
        // smulwt r10, r10, r9               // ....................................................................................*......................................................................................................................................................................................................................
        // usub16 r9, r5, r3                 // .............................................................................*.............................................................................................................................................................................................................................
        // smlabt r11, r11, r12, r0          // ......................................................................................*....................................................................................................................................................................................................................
        // uadd16 r8, r5, r3                 // ...............................................................................*...........................................................................................................................................................................................................................
        // smlabt r5, r10, r12, r0           // ........................................................................................*..................................................................................................................................................................................................................
        // uadd16 r1, r4, r1                 // ......................................................................*....................................................................................................................................................................................................................................
        // pkhtb r5, r5, r11, asr #16        // ...........................................................................................*...............................................................................................................................................................................................................
        // vmov r4, s20                      // ..................................................................................*........................................................................................................................................................................................................................
        // uadd16 r10, r14, r5               // ..................................................................................................*........................................................................................................................................................................................................
        // smulwb r11, r4, r7                // ....................................................................................................................*......................................................................................................................................................................................
        // smulwt r3, r4, r7                 // ..........................................................................................*................................................................................................................................................................................................................
        // vmov r4, s18                      // .....................................................................................................*.....................................................................................................................................................................................................
        // usub16 r5, r14, r5                // ................................................................................................*..........................................................................................................................................................................................................
        // smlabt r11, r11, r12, r0          // .........................................................................................................................*.................................................................................................................................................................................
        // vmov r7, s19                      // ............................................................................................*..............................................................................................................................................................................................................
        // smlabt r3, r3, r12, r0            // ....................................................................................................*......................................................................................................................................................................................................
        // smulwt r14, r4, r5                // ........................................................................................................*..................................................................................................................................................................................................
        // pkhtb r3, r3, r11, asr #16        // ..............................................................................................................................*............................................................................................................................................................................
        // smulwb r11, r7, r6                // ..............................................................................................*............................................................................................................................................................................................................
        // smlabt r14, r14, r12, r0          // ............................................................................................................*..............................................................................................................................................................................................
        // vmov s5, r3                       // ..................................................................................................................................*........................................................................................................................................................................
        // smulwb r3, r4, r5                 // .......................................................................................................*...................................................................................................................................................................................................
        // vmov r4, s21                      // ........................................................................................................................................*..................................................................................................................................................................
        // smlabt r11, r11, r12, r0          // .................................................................................................*.........................................................................................................................................................................................................
        // smlabt r3, r3, r12, r0            // ...........................................................................................................*...............................................................................................................................................................................................
        // smulwt r5, r7, r6                 // ...............................................................................................*...........................................................................................................................................................................................................
        // vmov r7, s17                      // ...................................................................................................................*.......................................................................................................................................................................................
        // smulwb r6, r7, r10                // .......................................................................................................................*...................................................................................................................................................................................
        // pkhtb r14, r14, r3, asr #16       // ..............................................................................................................*............................................................................................................................................................................................
        // smulwt r3, r7, r10                // .............................................................................................................................*.............................................................................................................................................................................
        // smlabt r6, r6, r12, r0            // ..........................................................................................................................*................................................................................................................................................................................
        // vmov s3, r14                      // ................................................................................................................*..........................................................................................................................................................................................
        // vmov r10, s22                     // .........................................................................................................*.................................................................................................................................................................................................
        // smlabt r3, r3, r12, r0            // .................................................................................................................................*.........................................................................................................................................................................
        // vmov r7, s11                      // .....................................................................................................................*.....................................................................................................................................................................................
        // smlabt r5, r5, r12, r0            // ...................................................................................................*.......................................................................................................................................................................................................
        // pkhtb r14, r3, r6, asr #16        // .....................................................................................................................................*.....................................................................................................................................................................
        // smulwb r6, r7, r1                 // ...............................................................................................................................*...........................................................................................................................................................................
        // pkhtb r3, r5, r11, asr #16        // ......................................................................................................*....................................................................................................................................................................................................
        // smulwt r5, r7, r1                 // ...................................................................................................................................*.......................................................................................................................................................................
        // vmov s2, r14                      // ......................................................................................................................................................*....................................................................................................................................................
        // smlabt r7, r6, r12, r0            // ......................................................................................................................................*....................................................................................................................................................................
        // vmov s4, r3                       // ..........................................................................................................*................................................................................................................................................................................................
        // smlabt r11, r5, r12, r0           // .......................................................................................................................................*...................................................................................................................................................................
        // smulwb r3, r10, r9                // .............................................................................................................*.............................................................................................................................................................................................
        // vmov r5, s16                      // ................................................................................................................................*..........................................................................................................................................................................
        // pkhtb r6, r11, r7, asr #16        // ..........................................................................................................................................*................................................................................................................................................................
        // smulwt r11, r10, r9               // ...............................................................................................................*...........................................................................................................................................................................................
        // uadd16 r14, r2, r6                // ............................................................................................................................................*..............................................................................................................................................................
        // smlabt r3, r3, r12, r0            // .................................................................................................................*.........................................................................................................................................................................................
        // usub16 r6, r2, r6                 // ..............................................................................................................................................*............................................................................................................................................................
        // vmov r2, s9                       // .........................................................................................................................................................................*.................................................................................................................................
        // smlabt r11, r11, r12, r0          // ..................................................................................................................*........................................................................................................................................................................................
        // smulwb r10, r4, r8                // ...........................................................................................................................................*...............................................................................................................................................................
        // vmov r1, s15                      // ....................................................................................................................................*......................................................................................................................................................................
        // pkhtb r7, r11, r3, asr #16        // ......................................................................................................................*....................................................................................................................................................................................
        // smulwt r9, r1, r14                // ................................................................................................................................................*..........................................................................................................................................................
        // vmov s7, r7                       // ........................................................................................................................*..................................................................................................................................................................................
        // smulwt r4, r4, r8                 // .........................................................................................................................................*.................................................................................................................................................................
        // smlabt r11, r10, r12, r0          // ..............................................................................................................................................................*............................................................................................................................................
        // vmov r3, s23                      // ...........................................................................................................................*...............................................................................................................................................................................
        // ldr.w r8, [r3, #256]              // .....................................................................................................................................................................................*.....................................................................................................................
        // smlabt r10, r4, r12, r0           // .............................................................................................................................................*.............................................................................................................................................................
        // ldr.w r7, [r3, #384]              // ....................................................................................................................................................*......................................................................................................................................................
        // smulwb r14, r1, r14               // ...............................................................................................................................................*...........................................................................................................................................................
        // pkhtb r11, r10, r11, asr #16      // ...................................................................................................................................................................*.......................................................................................................................................
        // smlabt r1, r9, r12, r0            // ...................................................................................................................................................*.......................................................................................................................................................
        // vmov s6, r11                      // .......................................................................................................................................................................*...................................................................................................................................
        // smlabt r4, r14, r12, r0           // .................................................................................................................................................*.........................................................................................................................................................
        // ldr.w r14, [r3, #192]             // ..................................................................................................................................................*........................................................................................................................................................
        // smulwt r10, r5, r6                // .......................................................................................................................................................*...................................................................................................................................................
        // vmov r11, s8                      // .............................................................................................................................................................*.............................................................................................................................................
        // smulwb r5, r5, r6                 // .....................................................................................................................................................*.....................................................................................................................................................
        // pkhtb r4, r1, r4, asr #16         // .........................................................................................................................................................*.................................................................................................................................................
        // smlabt r1, r10, r12, r0           // ............................................................................................................................................................*..............................................................................................................................................
        // smlabt r6, r5, r12, r0            // ..........................................................................................................................................................*................................................................................................................................................
        // movw r0, #24608                   // ......................................................................................................................................................................*....................................................................................................................................
        // vmov s0, r4                       // ...........................................................................................................................................................*...............................................................................................................................................
        // smulwb r9, r11, r8                // ........................................................................................................................................................................................*..................................................................................................................
        // ldr.w r4, [r3, #448]              // ............................................................................................................................*..............................................................................................................................................................................
        // smulwt r8, r11, r8                // ..........................................................................................................................................................................................*................................................................................................................
        // pkhtb r1, r1, r6, asr #16         // ...............................................................................................................................................................*...........................................................................................................................................
        // smlabt r10, r9, r12, r0           // ...........................................................................................................................................................................................*...............................................................................................................
        // vmov s1, r1                       // .................................................................................................................................................................*.........................................................................................................................................
        // smlabt r9, r8, r12, r0            // ..............................................................................................................................................................................................*............................................................................................................
        // smulwb r8, r11, r4                // ................................................................................................................................................................*..........................................................................................................................................
        // ldr.w r1, [r3, #0]                // ...................................................................................................................................................................................*.......................................................................................................................
        // pkhtb r10, r9, r10, asr #16       // ................................................................................................................................................................................................*..........................................................................................................
        // smulwt r9, r11, r4                // ....................................................................................................................................................................*......................................................................................................................................
        // usub16 r6, r1, r10                // ......................................................................................................................................................................................................*....................................................................................................
        // smlabt r5, r8, r12, r0            // ..........................................................................................................................................................................*................................................................................................................................
        // uadd16 r4, r1, r10                // ....................................................................................................................................................................................................*......................................................................................................
        // smlabt r8, r9, r12, r0            // ...........................................................................................................................................................................*...............................................................................................................................
        // ldr.w r1, [r3, #320]              // ........................................................................................................................................................*..................................................................................................................................................
        // smulwb r10, r11, r7               // .....................................................................................................................................................................*.....................................................................................................................................
        // pkhtb r5, r8, r5, asr #16         // ..............................................................................................................................................................................*............................................................................................................................
        // smulwt r8, r11, r7                // ..................................................................................................................................................................*........................................................................................................................................
        // smlabt r7, r10, r12, r0           // .............................................................................................................................................................................*.............................................................................................................................
        // ldr.w r10, [r3, #64]              // ............................................................................................................................................................................*..............................................................................................................................
        // ldr.w r9, [r3, #128]              // ............................................................................................................................................................................................*..............................................................................................................
        // smlabt r3, r8, r12, r0            // ........................................................................................................................................................................*..................................................................................................................................
        // smulwb r8, r11, r1                // ...............................................................................................................................................................................*...........................................................................................................................
        // pkhtb r3, r3, r7, asr #16         // ..................................................................................................................................................................................*........................................................................................................................
        // smulwt r1, r11, r1                // .................................................................................................................................................................................*.........................................................................................................................
        // usub16 r7, r9, r3                 // ........................................................................................................................................................................................................*..................................................................................................
        // smlabt r8, r8, r12, r0            // ....................................................................................................................................................................................*......................................................................................................................
        // uadd16 r11, r14, r5               // ................................................................................................................................................................................*..........................................................................................................................
        // smlabt r1, r1, r12, r0            // .......................................................................................................................................................................................*...................................................................................................................
        // uadd16 r9, r9, r3                 // .......................................................................................................................................................................................................*...................................................................................................
        // smulwb r3, r2, r11                // ...............................................................................................................................................................................................*...........................................................................................................
        // pkhtb r8, r1, r8, asr #16         // .........................................................................................................................................................................................*.................................................................................................................
        // smulwt r1, r2, r11                // .................................................................................................................................................................................................*.........................................................................................................
        // smlabt r11, r3, r12, r0           // ...................................................................................................................................................................................................*.......................................................................................................
        // usub16 r5, r14, r5                // ......................................................................................................................................................................................*....................................................................................................................
        // smlabt r14, r1, r12, r0           // .....................................................................................................................................................................................................*.....................................................................................................
        // uadd16 r3, r10, r8                // .............................................................................................................................................................................................*.............................................................................................................
        // smulwb r1, r2, r9                 // .........................................................................................................................................................................................................*.................................................................................................
        // pkhtb r14, r14, r11, asr #16      // ............................................................................................................................................................................................................*..............................................................................................
        // smulwt r9, r2, r9                 // ..........................................................................................................................................................................................................*................................................................................................
        // usub16 r11, r3, r14               // ................................................................................................................................................................................................................*..........................................................................................
        // smlabt r2, r1, r12, r0            // .............................................................................................................................................................................................................*.............................................................................................
        // smlabt r1, r9, r12, r0            // ...............................................................................................................................................................................................................*...........................................................................................
        // vmov r9, s12                      // ..........................................................................................................................................................................................................................*................................................................................
        // usub16 r10, r10, r8               // ..................................................................................................................................................................................................*........................................................................................................
        // smulwb r8, r9, r11                // .................................................................................................................................................................................................................................*.........................................................................
        // pkhtb r2, r1, r2, asr #16         // ....................................................................................................................................................................................................................*......................................................................................
        // smulwt r11, r9, r11               // ...................................................................................................................................................................................................................................*.......................................................................
        // vmov r9, s10                      // ...................................................................................................................................................................................................................*.......................................................................................
        // smlabt r1, r8, r12, r0            // ....................................................................................................................................................................................................................................*......................................................................
        // smlabt r11, r11, r12, r0          // ...........................................................................................................................................................................................................................................*...............................................................
        // uadd16 r8, r3, r14                // ..............................................................................................................................................................................................................*............................................................................................
        // smulwb r14, r9, r5                // .........................................................................................................................................................................................................................*.................................................................................
        // pkhtb r1, r11, r1, asr #16        // ...................................................................................................................................................................................................................................................*.......................................................
        // smulwb r11, r9, r7                // ......................................................................................................................................................................................................................................*....................................................................
        // usub16 r3, r4, r2                 // ......................................................................................................................................................................................................................*....................................................................................
        // smulwt r5, r9, r5                 // ...........................................................................................................................................................................................................................*...............................................................................
        // uadd16 r2, r4, r2                 // ........................................................................................................................................................................................................................*..................................................................................
        // smlabt r14, r14, r12, r0          // .............................................................................................................................................................................................................................*.............................................................................
        // smulwt r9, r9, r7                 // .......................................................................................................................................................................................................................................*...................................................................
        // vmov r7, s11                      // ...........................................................................................................................................................................................................*...............................................................................................
        // smlabt r11, r11, r12, r0          // .........................................................................................................................................................................................................................................*.................................................................
        // smlabt r4, r5, r12, r0            // ...............................................................................................................................................................................................................................*...........................................................................
        // usub16 r5, r3, r1                 // .............................................................................................................................................................................................................................................................*.............................................
        // smlabt r9, r9, r12, r0            // ..........................................................................................................................................................................................................................................*................................................................
        // pkhtb r4, r4, r14, asr #16        // ..................................................................................................................................................................................................................................*........................................................................
        // smulwb r14, r7, r8                // ..................................................................................................................................................................................................................*........................................................................................
        // pkhtb r11, r9, r11, asr #16       // .............................................................................................................................................................................................................................................*.............................................................
        // smulwt r8, r7, r8                 // .................................................................................................................................................................................................................*.........................................................................................
        // usub16 r7, r6, r11                // .......................................................................................................................................................................................................................................................*...................................................
        // smlabt r9, r14, r12, r0           // .......................................................................................................................................................................................................................*...................................................................................
        // uadd16 r14, r3, r1                // .........................................................................................................................................................................................................................................................*.................................................
        // smlabt r3, r8, r12, r0            // .....................................................................................................................................................................................................................*.....................................................................................
        // uadd16 r1, r10, r4                // ........................................................................................................................................................................................................................................*..................................................................
        // vmov r8, s13                      // ............................................................................................................................................................................................................................................*..............................................................
        // pkhtb r9, r3, r9, asr #16         // ............................................................................................................................................................................................................................*..............................................................................
        // smulwb r3, r8, r1                 // ..............................................................................................................................................................................................................................................*............................................................
        // usub16 r10, r10, r4               // .....................................................................................................................................................................................................................................*.....................................................................
        // smulwt r8, r8, r1                 // ................................................................................................................................................................................................................................................*..........................................................
        // usub16 r4, r2, r9                 // ..............................................................................................................................................................................................................................*............................................................................
        // smlabt r1, r3, r12, r0            // .................................................................................................................................................................................................................................................*.........................................................
        // uadd16 r6, r6, r11                // ...............................................................................................................................................................................................................................................*...........................................................
        // smlabt r8, r8, r12, r0            // ........................................................................................................................................................................................................................................................*..................................................
        // uadd16 r9, r2, r9                 // ................................................................................................................................................................................................................................*..........................................................................
        // vmov r3, s14                      // ..................................................................................................................................................................................................................................................*........................................................
        // pkhtb r2, r8, r1, asr #16         // ...........................................................................................................................................................................................................................................................*...............................................
        // smulwb r11, r3, r10               // .....................................................................................................................................................................................................................................................*.....................................................
        // smulwt r3, r3, r10                // ....................................................................................................................................................................................................................................................*......................................................
        // vmov r8, s5                       // ....................................................................................................................................................................................................................................................................................*......................
        // uadd16 r10, r6, r2                // ...........................................................................................................................................................................................................................................................................*...............................
        // smlabt r1, r11, r12, r0           // ..........................................................................................................................................................................................................................................................*................................................
        // usub16 r6, r6, r2                 // .........................................................................................................................................................................................................................................................................*.................................
        // smlabt r11, r3, r12, r0           // ............................................................................................................................................................................................................................................................*..............................................
        // usub16 r3, r6, r8                 // ...................................................................................................................................................................................................................................................................................................*.......
        // vmov r0, s23                      // ................................................................................................................................................................................................................................................................*..........................................
        // pkhtb r11, r11, r1, asr #16       // ...............................................................................................................................................................................................................................................................*...........................................
        // vmov r1, s3                       // ..............................................................................................................................................................................................................................................................*............................................
        // usub16 r2, r7, r11                // .......................................................................................................................................................................................................................................................................................*...................
        // str.w r3, [r0, #352]              // ....................................................................................................................................................................................................................................................................................................*......
        // uadd16 r11, r7, r11               // .............................................................................................................................................................................................................................................................................*.............................
        // vmov r7, s1                       // ..........................................................................................................................................................................................................................................................................*................................
        // uadd16 r3, r4, r7                 // ...................................................................................................................................................................................................................................................................................*.......................
        // str.w r3, [r0, #64]               // ........................................................................................................................................................................................................................................................................................*..................
        // usub16 r3, r4, r7                 // ...............................................................................................................................................................................................................................................................................*...........................
        // str.w r3, [r0, #96]               // ................................................................................................................................................................................................................................................................................*..........................
        // uadd16 r3, r5, r1                 // ...................................................................................................................................................................................................................................................................*.......................................
        // str.w r3, [r0, #192]              // ....................................................................................................................................................................................................................................................................*......................................
        // uadd16 r4, r6, r8                 // .....................................................................................................................................................................................................................................................................................*.....................
        // vmov r7, s2                       // ......................................................................................................................................................................................................................................................*....................................................
        // usub16 r5, r5, r1                 // .................................................................................................................................................................................................................................................................*.........................................
        // vmov r1, s7                       // ..............................................................................................................................................................................................................................................................................*............................
        // uadd16 r3, r2, r1                 // ...........................................................................................................................................................................................................................................................................................*...............
        // str.w r5, [r0, #224]              // ..................................................................................................................................................................................................................................................................*........................................
        // usub16 r5, r2, r1                 // .................................................................................................................................................................................................................................................................................................*.........
        // str.w r5, [r0, #480]              // ..................................................................................................................................................................................................................................................................................................*........
        // uadd16 r2, r14, r7                // .....................................................................................................................................................................................................................................................................*.....................................
        // str.w r4, [r0, #320]              // ......................................................................................................................................................................................................................................................................................*....................
        // str.w r3, [r0, #448]              // ..............................................................................................................................................................................................................................................................................................*............
        // vmov r1, s4                       // ............................................................................................................................................................................................................................................................................*..............................
        // vmov r5, s6                       // ............................................................................................................................................................................................................................................................................................*..............
        // str.w r2, [r0, #128]              // ......................................................................................................................................................................................................................................................................*....................................
        // uadd16 r3, r10, r1                // .........................................................................................................................................................................................................................................................................................*.................
        // str.w r3, [r0, #256]              // ..........................................................................................................................................................................................................................................................................................*................
        // uadd16 r8, r11, r5                // .......................................................................................................................................................................................................................................................................................................*...
        // str.w r8, [r0, #384]              // ........................................................................................................................................................................................................................................................................................................*..
        // usub16 r2, r10, r1                // .................................................................................................................................................................................................................................................................................*.........................
        // vmov r1, s0                       // .............................................................................................................................................................................................................................................................................................*.............
        // usub16 r3, r11, r5                // ...............................................................................................................................................................................................................................................................................................*...........
        // str.w r3, [r0, #416]              // ................................................................................................................................................................................................................................................................................................*..........
        // usub16 r10, r9, r1                // .....................................................................................................................................................................................................................................................................................................*.....
        // str.w r10, [r0, #32]              // ......................................................................................................................................................................................................................................................................................................*....
        // str.w r2, [r0, #288]              // ..................................................................................................................................................................................................................................................................................*........................
        // usub16 r4, r14, r7                // .......................................................................................................................................................................................................................................................................*...................................
        // str.w r4, [r0, #160]              // ........................................................................................................................................................................................................................................................................*..................................
        // uadd16 r14, r9, r1                // .........................................................................................................................................................................................................................................................................................................*.
        // str.w r14, [r0], #4               // ..........................................................................................................................................................................................................................................................................................................*

        vmov tmp, s24
        cmp poly, tmp
        bne layer1234_loop

 sub.w poly, #8*strincr

 ### LAYER 3+2+1

 .equ distance2, distance/16
 .equ strincr2, 32

 add.w tmp, poly, #strincr2*16
 vmov s13, tmp
        vmov twiddle_ptr, s25
layer567_loop:
                                            // Instructions:    112
                                            // Expected cycles: 62
                                            // Expected IPC:    1.81
                                            //
                                            // ---------------------------------------------- original position ---------------------------------------------->
                                            // 0                        25                       50                       75                       100
                                            // |------------------------|------------------------|------------------------|------------------------|-----------
        ldr.w r7, [r1], #28                 // *...............................................................................................................
        ldr.w r3, [r0, #24]                 // ...*............................................................................................................
        ldr r8, [r1, #-24]                  // .................................*..............................................................................
        ldr.w r2, [r0, #20]                 // .......*........................................................................................................
        ldr.w r6, [r0, #8]                  // ...............................*................................................................................
        smulwb r10, r7, r3                  // ......................*.........................................................................................
        smulwb r9, r7, r2                   // ............*...................................................................................................
        // gap                              // ................................................................................................................
        smulwt r14, r7, r2                  // ..............*.................................................................................................
        movw r5, #24608                     // ........*.......................................................................................................
        smlabt r4, r9, r12, r5              // ................*...............................................................................................
        ldr.w r11, [r0, #28]                // ....*...........................................................................................................
        smlabt r14, r14, r12, r5            // ..................*.............................................................................................
        ldr.w r2, [r0, #4]                  // ...................*............................................................................................
        smulwt r9, r7, r3                   // ....................*...........................................................................................
        // gap                              // ................................................................................................................
        pkhtb r14, r14, r4, asr #16         // .....................*..........................................................................................
        smlabt r10, r10, r12, r5            // ..........................*.....................................................................................
        uadd16 r3, r2, r14                  // .......................*........................................................................................
        smlabt r9, r9, r12, r5              // ........................*.......................................................................................
        usub16 r4, r2, r14                  // ...........................*....................................................................................
        smulwb r2, r7, r11                  // .............................*..................................................................................
        pkhtb r14, r9, r10, asr #16         // ............................*...................................................................................
        smulwt r11, r7, r11                 // ..............................*.................................................................................
        uadd16 r9, r6, r14                  // ..................................*.............................................................................
        smlabt r2, r2, r12, r5              // ................................*...............................................................................
        usub16 r10, r6, r14                 // ....................................*...........................................................................
        smulwb r14, r8, r9                  // .....................................*..........................................................................
        ldr.w r6, [r0, #12]                 // ..*.............................................................................................................
        smulwt r9, r8, r9                   // .......................................*........................................................................
        vmov s26, r3                        // .........................*...................................................................................... // @slothy:is_spill // @slothy:writes=stack_0
        smlabt r14, r14, r12, r5            // .........................................*......................................................................
        smlabt r3, r9, r12, r5              // ...........................................*....................................................................
        ldr r9, [r1, #-20]                  // ...............................................*................................................................
        smlabt r11, r11, r12, r5            // ...................................*............................................................................
        // gap                              // ................................................................................................................
        pkhtb r3, r3, r14, asr #16          // .............................................*..................................................................
        smulwb r14, r9, r10                 // ..................................................*.............................................................
        pkhtb r2, r11, r2, asr #16          // ......................................*.........................................................................
        smulwt r11, r9, r10                 // ....................................................*...........................................................
        uadd16 r10, r6, r2                  // ..........................................*.....................................................................
        smlabt r14, r14, r12, r5            // ......................................................*.........................................................
        usub16 r2, r6, r2                   // ........................................*.......................................................................
        smlabt r11, r11, r12, r5            // ........................................................*.......................................................
        smulwb r6, r9, r2                   // .........................................................*......................................................
        // gap                              // ................................................................................................................
        pkhtb r14, r11, r14, asr #16        // ..........................................................*.....................................................
        smulwt r2, r9, r2                   // ...........................................................*....................................................
        ldr.w r11, [r0, #16]                // .*..............................................................................................................
        smlabt r6, r6, r12, r5              // .............................................................*..................................................
        smlabt r2, r2, r12, r5              // ...............................................................*................................................
        // gap                              // ................................................................................................................
        smulwt r9, r7, r11                  // ......*.........................................................................................................
        // gap                              // ................................................................................................................
        pkhtb r6, r2, r6, asr #16           // .................................................................*..............................................
        smulwb r11, r7, r11                 // .....*..........................................................................................................
        uadd16 r2, r4, r6                   // ...................................................................*............................................
        smlabt r7, r9, r12, r5              // ..........*.....................................................................................................
        usub16 r9, r4, r6                   // ....................................................................*...........................................
        smlabt r4, r11, r12, r5             // .........*......................................................................................................
        ldr r11, [r1, #-8]                  // ................................................................*...............................................
        smulwb r6, r8, r10                  // ............................................*...................................................................
        smulwt r8, r8, r10                  // ..............................................*.................................................................
        // gap                              // ................................................................................................................
        pkhtb r7, r7, r4, asr #16           // .............*..................................................................................................
        smulwb r10, r11, r2                 // .....................................................................*..........................................
        ldr.w r4, [r0, #0]                  // ...........*....................................................................................................
        smulwt r11, r11, r2                 // ......................................................................*.........................................
        uadd16 r2, r4, r7                   // .................*..............................................................................................
        smlabt r10, r10, r12, r5            // .........................................................................*......................................
        usub16 r4, r4, r7                   // ...............*................................................................................................
        smlabt r7, r11, r12, r5             // ...........................................................................*....................................
        uadd16 r11, r4, r14                 // ..............................................................*.................................................
        smlabt r6, r6, r12, r5              // ................................................*...............................................................
        pkhtb r10, r7, r10, asr #16         // ..............................................................................*.................................
        smlabt r7, r8, r12, r5              // .................................................*..............................................................
        uadd16 r8, r11, r10                 // ....................................................................................*...........................
        str.w r8, [r0, #16]                 // .....................................................................................................*..........
        pkhtb r8, r7, r6, asr #16           // ...................................................*............................................................
        vmov r7, s26                        // .......................................................................*........................................ // @slothy:is_restore // @slothy:reads=stack_0
        usub16 r11, r11, r10                // ..................................................................................*.............................
        ldr r10, [r1, #-16]                 // ..................................................................*.............................................
        uadd16 r6, r7, r8                   // ..........................................................................*.....................................
        str.w r11, [r0, #20]                // .........................................................................................*......................
        usub16 r7, r7, r8                   // ............................................................................*...................................
        // gap                              // ................................................................................................................
        usub16 r4, r4, r14                  // ............................................................*...................................................
        smulwb r8, r10, r6                  // .............................................................................*..................................
        smulwt r10, r10, r6                 // ...............................................................................*................................
        vmov s26, r4                        // ........................................................................*....................................... // @slothy:is_spill // @slothy:writes=stack_0
        smlabt r11, r8, r12, r5             // ................................................................................*...............................
        ldr r8, [r1, #-12]                  // .......................................................................................*........................
        usub16 r6, r2, r3                   // .....................................................*..........................................................
        ldr r4, [r1, #-4]                   // .................................................................................*..............................
        uadd16 r3, r2, r3                   // .......................................................*........................................................
        smulwt r2, r8, r7                   // .............................................................................................*..................
        smulwb r8, r8, r7                   // ...........................................................................................*....................
        vmov r7, s26                        // ...............................................................................................*................ // @slothy:is_restore // @slothy:reads=stack_0
        smulwt r14, r4, r9                  // ......................................................................................*.........................
        // gap                              // ................................................................................................................
        smulwb r4, r4, r9                   // .....................................................................................*..........................
        // gap                              // ................................................................................................................
        smlabt r10, r10, r12, r5            // ...................................................................................*............................
        // gap                              // ................................................................................................................
        smlabt r8, r8, r12, r5              // ..............................................................................................*.................
        // gap                              // ................................................................................................................
        pkhtb r11, r10, r11, asr #16        // ........................................................................................*.......................
        smlabt r2, r2, r12, r5              // ................................................................................................*...............
        usub16 r10, r3, r11                 // ............................................................................................*...................
        smlabt r14, r14, r12, r5            // .................................................................................................*..............
        pkhtb r2, r2, r8, asr #16           // ..................................................................................................*.............
        smlabt r4, r4, r12, r5              // ...................................................................................................*............
        uadd16 r8, r6, r2                   // ......................................................................................................*.........
        str.w r10, [r0, #4]                 // ........................................................................................................*.......
        usub16 r2, r6, r2                   // ....................................................................................................*...........
        str.w r8, [r0, #8]                  // ..........................................................................................................*.....
        uadd16 r3, r3, r11                  // ..........................................................................................*.....................
        str.w r3, [r0], #32                 // .......................................................................................................*........
        pkhtb r14, r14, r4, asr #16         // .........................................................................................................*......
        str.w r2, [r0, #-20]                // ...............................................................................................................*
        uadd16 r3, r7, r14                  // ...........................................................................................................*....
        str.w r3, [r0, #-8]                 // ............................................................................................................*...
        usub16 r3, r7, r14                  // .............................................................................................................*..
        str.w r3, [r0, #-4]                 // ..............................................................................................................*.

                                            // ------------------------------------------------ new position ------------------------------------------------->
                                            // 0                        25                       50                       75                       100
                                            // |------------------------|------------------------|------------------------|------------------------|-----------
        // ldr.w r2, [r1], #28              // *...............................................................................................................
        // ldr.w r7, [r0, #16]              // ............................................*...................................................................
        // ldr.w r10, [r0, #12]             // ..........................*.....................................................................................
        // ldr.w r14, [r0, #24]             // .*..............................................................................................................
        // ldr.w r11, [r0, #28]             // ..........*.....................................................................................................
        // smulwb r8, r2, r7                // .................................................*..............................................................
        // smulwt r4, r2, r7                // ...............................................*................................................................
        // ldr.w r6, [r0, #20]              // ...*............................................................................................................
        // movw r5, #24608                  // ........*.......................................................................................................
        // smlabt r7, r8, r12, r5           // .....................................................*..........................................................
        // smlabt r4, r4, r12, r5           // ...................................................*............................................................
        // ldr.w r3, [r0, #0]               // ...........................................................*....................................................
        // smulwb r8, r2, r6                // ......*.........................................................................................................
        // pkhtb r4, r4, r7, asr #16        // .........................................................*......................................................
        // smulwt r6, r2, r6                // .......*........................................................................................................
        // usub16 r7, r3, r4                // ...............................................................*................................................
        // smlabt r9, r8, r12, r5           // .........*......................................................................................................
        // uadd16 r3, r3, r4                // .............................................................*..................................................
        // smlabt r4, r6, r12, r5           // ...........*....................................................................................................
        // ldr.w r6, [r0, #4]               // ............*...................................................................................................
        // smulwt r8, r2, r14               // .............*..................................................................................................
        // pkhtb r4, r4, r9, asr #16        // ..............*.................................................................................................
        // smulwb r9, r2, r14               // .....*..........................................................................................................
        // uadd16 r14, r6, r4               // ................*...............................................................................................
        // smlabt r8, r8, r12, r5           // .................*..............................................................................................
        // vmov s26, r14                    // ............................*...................................................................................
        // smlabt r9, r9, r12, r5           // ...............*................................................................................................
        // usub16 r4, r6, r4                // ..................*.............................................................................................
        // pkhtb r14, r8, r9, asr #16       // ....................*...........................................................................................
        // smulwb r8, r2, r11               // ...................*............................................................................................
        // smulwt r6, r2, r11               // .....................*..........................................................................................
        // ldr.w r9, [r0, #8]               // ....*...........................................................................................................
        // smlabt r2, r8, r12, r5           // .......................*........................................................................................
        // ldr r8, [r1, #-24]               // ..*.............................................................................................................
        // uadd16 r11, r9, r14              // ......................*.........................................................................................
        // smlabt r6, r6, r12, r5           // ................................*...............................................................................
        // usub16 r14, r9, r14              // ........................*.......................................................................................
        // smulwb r9, r8, r11               // .........................*......................................................................................
        // pkhtb r2, r6, r2, asr #16        // ...................................*............................................................................
        // smulwt r6, r8, r11               // ...........................*....................................................................................
        // usub16 r11, r10, r2              // .......................................*........................................................................
        // smlabt r9, r9, r12, r5           // .............................*..................................................................................
        // uadd16 r2, r10, r2               // .....................................*..........................................................................
        // smlabt r6, r6, r12, r5           // ..............................*.................................................................................
        // smulwb r10, r8, r2               // .......................................................*........................................................
        // pkhtb r6, r6, r9, asr #16        // .................................*..............................................................................
        // smulwt r8, r8, r2                // ........................................................*.......................................................
        // ldr r9, [r1, #-20]               // ...............................*................................................................................
        // smlabt r2, r10, r12, r5          // ..................................................................*.............................................
        // smlabt r10, r8, r12, r5          // ....................................................................*...........................................
        // smulwb r8, r9, r14               // ..................................*.............................................................................
        // pkhtb r2, r10, r2, asr #16       // .......................................................................*........................................
        // smulwt r14, r9, r14              // ....................................*...........................................................................
        // usub16 r10, r3, r6               // ....................................................................................*...........................
        // smlabt r8, r8, r12, r5           // ......................................*.........................................................................
        // uadd16 r6, r3, r6                // ......................................................................................*.........................
        // smlabt r14, r14, r12, r5         // ........................................*.......................................................................
        // smulwb r3, r9, r11               // .........................................*......................................................................
        // pkhtb r14, r14, r8, asr #16      // ..........................................*.....................................................................
        // smulwt r9, r9, r11               // ...........................................*....................................................................
        // usub16 r8, r7, r14               // ..............................................................................*.................................
        // smlabt r11, r3, r12, r5          // .............................................*..................................................................
        // uadd16 r14, r7, r14              // .................................................................*..............................................
        // smlabt r9, r9, r12, r5           // ..............................................*.................................................................
        // ldr r3, [r1, #-8]                // ......................................................*.........................................................
        // pkhtb r9, r9, r11, asr #16       // ................................................*...............................................................
        // ldr r7, [r1, #-16]               // ..........................................................................*.....................................
        // uadd16 r11, r4, r9               // ..................................................*.............................................................
        // usub16 r9, r4, r9                // ....................................................*...........................................................
        // smulwb r4, r3, r11               // ..........................................................*.....................................................
        // smulwt r3, r3, r11               // ............................................................*...................................................
        // vmov r11, s26                    // ........................................................................*.......................................
        // vmov s26, r8                     // .................................................................................*..............................
        // smlabt r8, r4, r12, r5           // ..............................................................*.................................................
        // uadd16 r4, r11, r2               // ...........................................................................*....................................
        // smlabt r3, r3, r12, r5           // ................................................................*...............................................
        // usub16 r2, r11, r2               // .............................................................................*..................................
        // smulwb r11, r7, r4               // ...............................................................................*................................
        // pkhtb r3, r3, r8, asr #16        // ...................................................................*............................................
        // smulwt r7, r7, r4                // ................................................................................*...............................
        // smlabt r8, r11, r12, r5          // ..................................................................................*.............................
        // ldr r11, [r1, #-4]               // .....................................................................................*..........................
        // usub16 r4, r14, r3               // .........................................................................*......................................
        // smlabt r7, r7, r12, r5           // ............................................................................................*...................
        // uadd16 r3, r14, r3               // .....................................................................*..........................................
        // smulwb r14, r11, r9              // ...........................................................................................*....................
        // smulwt r11, r11, r9              // ..........................................................................................*.....................
        // ldr r9, [r1, #-12]               // ...................................................................................*............................
        // pkhtb r8, r7, r8, asr #16        // ..............................................................................................*.................
        // str.w r4, [r0, #20]              // ............................................................................*...................................
        // uadd16 r4, r6, r8                // ........................................................................................................*.......
        // smulwb r7, r9, r2                // ........................................................................................*.......................
        // usub16 r6, r6, r8                // ................................................................................................*...............
        // smulwt r2, r9, r2                // .......................................................................................*........................
        // smlabt r8, r7, r12, r5           // .............................................................................................*..................
        // vmov r7, s26                     // .........................................................................................*......................
        // smlabt r2, r2, r12, r5           // ...............................................................................................*................
        // smlabt r11, r11, r12, r5         // .................................................................................................*..............
        // pkhtb r2, r2, r8, asr #16        // ..................................................................................................*.............
        // smlabt r8, r14, r12, r5          // ...................................................................................................*............
        // usub16 r5, r10, r2               // ......................................................................................................*.........
        // str.w r3, [r0, #16]              // ......................................................................*.........................................
        // uadd16 r3, r10, r2               // ....................................................................................................*...........
        // str.w r4, [r0], #32              // .........................................................................................................*......
        // str.w r6, [r0, #-28]             // .....................................................................................................*..........
        // pkhtb r14, r11, r8, asr #16      // ..........................................................................................................*.....
        // str.w r3, [r0, #-24]             // .......................................................................................................*........
        // uadd16 r3, r7, r14               // ............................................................................................................*...
        // str.w r3, [r0, #-8]              // .............................................................................................................*..
        // usub16 r3, r7, r14               // ..............................................................................................................*.
        // str.w r3, [r0, #-4]              // ...............................................................................................................*
        // str.w r5, [r0, #-20]             // ...........................................................................................................*....

        vmov tmp, s13
        cmp poly, tmp
        bne layer567_loop
 vpop.w {s16-s27}
 pop {r4-r11, pc}
